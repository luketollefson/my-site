<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>My Hakyll Blog - Create a Simple Web App with Unison and Elm</title>
        <link rel="stylesheet" href="../css/default.css" />
        <link rel="stylesheet" href="../css/syntax.css" />
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Lora&display=swap" rel="stylesheet"> 
        <link href="https://fonts.googleapis.com/css2?family=DM+Mono&display=swap" rel="stylesheet"> 
        <style>
            body {
            
              font-family: 'Lora', sans-serif;
              font-size: 20px;
            }
            div.sourceCode {
                font-family: 'DM Mono', monospace;
                font-size: 16px;
                margin-left: 20px;
            }
            code {
                font-family: 'DM Mono', monospace;
                font-size: 16px;
            }
        </style>
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">My Hakyll Blog</a>
            </div>
            <nav>
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </nav>
        </header>

        <main role="main">
            <h1>Create a Simple Web App with Unison and Elm</h1>
            <article>
    <section class="header">
        Posted on July 26, 2022
        
    </section>
    <section>
        <h1 id="introduction">Introduction</h1>
<p>Lets create a simple web app that lets a user increment and decrement an number. We will use Unison to create a backend service and use Elm to create a frontend service.</p>
<p align="center" width="100%">
<img width="66%" src="../images/unison-elm-demo.png" />
<br>
Screenshot of the Web App
</p>
<h2 id="what-is-unison">What is Unison?</h2>
<p>Unison, as the website puts it, is a language “from the future”. It departs from the conventional file based programming and instead stores all the code into a single hash table. This allows you to reference any code ever written by the hash of the code.</p>
<p>This novel code storage paradigm simplifies a great deal of hard problems in computer science, including distributed computing, durable stoarge, dependency managamgnet, refactoring, and more the longer you think on it. More information, and just how these problems are simplified can be found on the <a href="https://www.unison-lang.org/">Unison website</a> and its <a href="https://www.unison-lang.org/learn/the-big-idea/">big ideas page</a>.</p>
<p>We will use Unison as our backend language</p>
<h2 id="what-is-elm">What is Elm?</h2>
<p>Elm is a better known functionall programming language used for frontend development It has a Haskell like look. You can find more information on its <a href="https://elm-lang.org/">offcial website</a>.</p>
<p>We will Elm as our frontend language.</p>
<h2 id="why-unison-and-elm">Why Unison and Elm?</h2>
<p>Both Unison and Elm have a ML look and neither Haskell-like typeclasses. I can’t find an explaination of why Elm doesn’t have typeclasses (<a href="https://github.com/elm/compiler/issues/396">only this</a>). Between <a href="https://www.unisonweb.org/2019/04/04/writeup-of-our-first-unison-meetup/#other-questions">this post</a> and <a href="http://pchiusano.github.io/2018-02-13/typeclasses.html">this post</a> the Unison developers explain how typeclasses create a global cohereance. Requiring global cohereance for Unison would be compromising the flexility it’s code storage model. Edward Kmett has a <a href="https://youtu.be/hIZxTQP1ifo">good presentation of this global coherance problem on YouTube</a>. And Gabriella Gonzalez wrote the infamous <a href="https://www.haskellforall.com/2012/05/scrap-your-type-classes.html">“Scrap your type classes”</a> bashing Haskell type classes for a variety of reasons.</p>
<p>In my experience, typeclasses are easier then the alternative of having <code>List.map</code>, <code>Map.map</code>, <code>Tree.map</code>, etc. Admittedly, most of my FP experience is limited to Haskell, but I at least want to be able to choose which level of abstraction I’m working on, and not be prescribed to only work on concrete data types. And I like how typeclasses let me do this. But Unison’s choice to not have them makes a ton of sense.</p>
<p>Maybe my narrow focus on Haskell has kept my mind shut from other idea, but I believe marrying Haskell typeclasses with Unison code base would make the worlds best programming language. But, to my knowledge, no one has cracked this problem. If someone can point me to the latest (and foundational) research on typeclasses and this global coherence issue, that would be appricited. Now, Let us go on a write our Unison backend.</p>
<h1 id="create-our-unison-backend">Create Our Unison Backend</h1>
<p>Our backend will know three routes: the <code>"/"</code> route will request the counter’s state; the <code>"/increment"</code> route will increment the couter’s state by one; and the <code>"/decrement"</code> route will decrement the coutner’s state by one. The backend will also save the counter to a <em>counter.ubin</em> file after every request.</p>
<p>First, let us install the necessary dependencies to start writing our backend.</p>
<h2 id="installing-http-logging-and-file-libraries-in-unison-codebase-manager-ucm">Installing <code>http</code>, <code>logging</code>, and <code>file</code> Libraries in Unison Codebase Manager (UCM)</h2>
<p>To create the server we will need <a href="https://share.unison-lang.org/users/unison/code/latest/namespaces/public/http">the Unison <code>http</code> library</a>. However, the library isn’t set up for us to use custom abilities in the request handler, so instead we need this branch I made (this could change tomorrow! Unison’s <code>http</code> library is still in the works!). To download my branch of the <code>http</code> library run the following in <code>ucm</code></p>
<pre><code>.&gt; pull luketollefson.public.prs._genericRequestHandler lib._genericRequestHandler</code></pre>
<p>We will also need the <code>logging</code> library for logging and the <code>file</code> library for file-based IO.</p>
<pre><code>.&gt; pull stew.public.projects.logging.latest lib.logging
.&gt; pull git(https://github.com/unisonweb/share).chrispenner.file lib.file </code></pre>
<h2 id="the-web-service-function-serveweb">The Web Service Function <code>serveWeb</code></h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>serveWeb <span class="op">:</span> '{<span class="dt">IO</span>, <span class="dt">Exception</span>} ()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>serveWeb _ <span class="ot">=</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  durableStorage <span class="ot">=</span> <span class="dt">FilePath</span> <span class="st">&quot;counter.ubin&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  initialState <span class="ot">=</span>                            <span class="co">-- 1) Initialize counter</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Either</span><span class="op">.</span>fold (<span class="fu">const</span> <span class="dv">0</span>) <span class="fu">id</span> (Exception.catch '(readDurable durableStorage))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  run <span class="ot">=</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    host <span class="ot">=</span> <span class="dt">HostName</span> <span class="st">&quot;127.0.0.1&quot;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    port <span class="ot">=</span> <span class="dt">ServiceName</span> <span class="st">&quot;5556&quot;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    saveAfter r <span class="ot">=</span>                           <span class="co">-- 2) Save counter after request</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      res <span class="ot">=</span> handleRequest r</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      saveStore durableStorage</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>      res</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    requestHandler <span class="ot">=</span> <span class="dt">RequestHandler</span> saveAfter</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    server host port requestHandler</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  unsafeRun<span class="op">!</span>                                <span class="co">-- 3) Run the server</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    ('handle (Store.withInitialValue initialState run) </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        with Log.default <span class="st">&quot;Example Web App&quot;</span>)</span></code></pre></div>
<p>In <code>serveWeb</code> we define our server’s “<code>main</code>” function. This function will be ran with <code>run serveWeb</code> in UCM. At comment #1 we initalize the counter for our runtime. When <em>counter.ubin</em> exists we set <code>initialState</code> to the value within it, otherwise our <code>initialState</code> will be <code>0</code>. At comment #2 we wrap our request handler <code>handleRequest</code> in code that saves our counter into durable storage after every request. In comment #3 we actually run the server function <code>run</code>.</p>
<h2 id="the-request-handler-handlerequest">The Request Handler <code>handleRequest</code></h2>
<p>Broadly, a backend service will take in a request and emit back a response to a client. So we can think of our service as function from a request to a response, written as a type this is <code>SimpleHttpRequest -&gt;{g} SimpleHttpResponse</code> where <code>{g}</code> allows us to tag any ability in the function. In our case, <code>handleRequest</code> is our handler and it looks like this:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>handleRequest <span class="op">:</span> <span class="dt">SimpleHttpRequest</span> <span class="ot">-&gt;</span>{<span class="dt">Store</span> <span class="dt">Nat</span>} <span class="dt">SimpleHttpResponse</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>handleRequest req <span class="ot">=</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  (<span class="dt">RequestURI</span> (<span class="dt">Path</span> p) _ _) <span class="ot">=</span> requestURI req    <span class="co">--  Get the path p</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  match p with</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;/&quot;</span> <span class="ot">-&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>      set cors (okText (Nat.toText Store.get))  <span class="co">--  Return the counter</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;/increment&quot;</span> <span class="ot">-&gt;</span>                     </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>      Store.modify (n <span class="ot">-&gt;</span> n <span class="op">+</span> <span class="dv">1</span>)                 <span class="co">--  Increment counter</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>      set cors (ok Bytes.empty)                 <span class="co">--  Return nothing</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;/decrement&quot;</span> <span class="ot">-&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>      Store.modify (n <span class="ot">-&gt;</span> n <span class="op">-</span> <span class="dv">1</span>)                 <span class="co">--  Decrement counter</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      set cors (ok Bytes.empty)                 <span class="co">--  Return nothing</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    _  <span class="ot">-&gt;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="co">--  Return a bad request</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SimpleHttpResponse</span> cors <span class="dt">BadRequest</span> (<span class="dt">RawResponseBody</span> Bytes.empty)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>cors <span class="op">:</span> [<span class="dt">Header</span>]</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>cors <span class="ot">=</span> [<span class="dt">Header</span> <span class="st">&quot;Access-Control-Allow-Origin&quot;</span> <span class="st">&quot;*&quot;</span>]</span></code></pre></div>
<p>In <code>handleRequest</code> we first destruct the request URI’s path into <code>p</code>. Then we pattern match for <code>"/"</code>, <code>"/increment"</code>, <code>"/decrement"</code> or <code>_</code>. If we match <code>"/"</code> we will return the counter. If <code>"/increment"</code> or <code>"/decrement"</code> are matched we will increment or decrement the counter respectivly and return an empty response. All other <code>p</code> match the <code>_</code> case and return a error response.</p>
<p>Additionally, we define <code>cors</code> which fixes a CORS error. Setting <code>Access-Control-Allow-Origin=*</code> is bad practice, but for us it is simple enough for us.</p>
<h2 id="durable-storage">Durable Storage</h2>
<p>In the <code>saveAfter</code> definition of the <code>serveWeb</code> function we use the <code>saveStore</code> function. The <code>saveStore</code> function will save whatever in the store ability to durable storage, it is defined as</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>saveStore <span class="op">:</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span>{<span class="dt">IO</span>, <span class="dt">Exception</span>, <span class="dt">Store</span> a} ()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>saveStore path <span class="ot">=</span> writeDurable path (Store.get)</span></code></pre></div>
<p>One of the attractive parts of Unison is how easy durable storage should be. In theory, we should always be able to sensibly read data we have written since we have a full repository of all the data types that have been created. Maybe Unison will slay the SQL zombie? Though admittedly, it is hard to find documentation for it—I found the following works alright</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>readDurable <span class="op">:</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span>{<span class="dt">IO</span>, <span class="dt">Exception</span>} a</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>readDurable path <span class="ot">=</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  throwLoad a <span class="ot">=</span> Throw.toBug '(<span class="dt">Either</span><span class="op">.</span>toThrow (Value.load a))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  throwDeserialize b <span class="ot">=</span> Throw.toBug '(<span class="dt">Either</span><span class="op">.</span>toThrow (Value.deserialize b))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  throwLoad (throwDeserialize (file<span class="op">.</span>bytes<span class="op">.</span><span class="fu">readFile</span> path))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>writeDurable <span class="op">:</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span>{<span class="dt">IO</span>, <span class="dt">Exception</span>} ()</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>writeDurable path v <span class="ot">=</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  file<span class="op">.</span>bytes<span class="op">.</span><span class="fu">writeFile</span> path (Value.serialize (Value.value v))</span></code></pre></div>
<p>The function <code>readDurable</code> will give back and <code>a</code> from a particular <code>FilePath</code>. The helpers <code>throwLoad</code> and <code>throwDeserialized</code> basically serve to get <code>Value.load</code>, <code>Value.deserialize</code>, and <code>file.bytes.readFile</code> to compose nicely.</p>
<p>The function <code>writeDurable</code> will write <code>a</code> to a particular <code>FilePath</code>.</p>
<h2 id="playing-with-the-unison-backend-without-a-frontend">Playing with the Unison Backend without a Frontend</h2>
<p>In <code>ucm</code> run <code>run serveWeb</code> and browse to <a href="localhost:5556">localhost:5556</a>. You’ll see the number zero, and if you go to <a href="localhost:5556/increment">localhost:5556/increment</a> or <a href="localhost:5556/decrement">localhost:5556/decrement</a> the counter will be incremented or decremented the next time you go to <a href="localhost:5556">localhost:5556</a>.</p>
<p>You can restart the backend and the old counter will be loaded from <em>counter.ubin</em>. Though, in order to restart the backend you might have to change the port number. The port isn’t properly unbound when you stop the server.</p>
<h1 id="the-elm-frontend">The Elm Frontend</h1>
<p>I won’t dive into the Elm code. The code isn’t nearly as novel as the backend Unison code. If you can get through the <a href="https://guide.elm-lang.org/">Official Elm Guide</a> things should be easy to understand. After running the code you will see a the counter’s value and buttons to increment and decrement it.</p>
<h1 id="conclusion">Conclusion</h1>
<p>Even this toy example isn’t perfect, but I feel like it serves a good introduction to the possibility of using Unison as a backend language. Unison is a compelling language and the developer know what they are doing. I highly recommend giving the language a shot. Also, the compiler itself is written beautiful.</p>
<h1 id="dissolving-the-frontend-backend-separation">Dissolving the Frontend-Backend Separation?</h1>
<p>We might be able to reach for something higher than simply a Unison backend. I beleive the frontend-backend separation is an arbitrary separation and we should instead express this in a single expression. I’m not the only one who thinks this, <a href="https://www.hyperfiddle.net/">Hyperfiddle</a> seems like the best relization of this idea, and <a href="https://hyperfiddle.notion.site/Reactive-Clojure-You-don-t-need-a-web-framework-you-need-a-web-language-44b5bfa526be4af282863f34fa1cfffc">this blog post goes into the philosphy of this</a>.</p>
<p>I’m also have my own thing going on here in Haskell called <a href="https://github.com/luketollefson/handshake"><code>handshake</code></a> to model client-server relationships. Unfortunately, I’m unsure if you can send higher-order functions over a wire in Haskell, this is where Unison shines. We’ll see where my thing goes.</p>
<p>If Unison compiled to JS we might be able to dissolve the frontend-backend separation and write everything in Unison—who knows.</p>
<h1 id="full-unison-source-code">Full Unison Source Code</h1>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>serveWeb <span class="op">:</span> '{<span class="dt">IO</span>, <span class="dt">Exception</span>} ()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>serveWeb _ <span class="ot">=</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  durableStorage <span class="ot">=</span> <span class="dt">FilePath</span> <span class="st">&quot;counter.ubin&quot;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  initialState <span class="ot">=</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Either</span><span class="op">.</span>fold (<span class="fu">const</span> <span class="dv">0</span>) <span class="fu">id</span> (Exception.catch '(readDurable durableStorage))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  run <span class="ot">=</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    host <span class="ot">=</span> <span class="dt">HostName</span> <span class="st">&quot;127.0.0.1&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    port <span class="ot">=</span> <span class="dt">ServiceName</span> <span class="st">&quot;5556&quot;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    saveAfter r <span class="ot">=</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      res <span class="ot">=</span> handleRequest r</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>      saveStore durableStorage</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      res</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    requestHandler <span class="ot">=</span> <span class="dt">RequestHandler</span> saveAfter</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    server host port requestHandler</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  unsafeRun<span class="op">!</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    ('handle (Store.withInitialValue initialState run) </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        with Log.default <span class="st">&quot;Example Web App&quot;</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>handleRequest <span class="op">:</span> <span class="dt">SimpleHttpRequest</span> <span class="ot">-&gt;</span>{<span class="dt">Store</span> <span class="dt">Nat</span>} <span class="dt">SimpleHttpResponse</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>handleRequest req <span class="ot">=</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  (<span class="dt">RequestURI</span> (<span class="dt">Path</span> p) _ _) <span class="ot">=</span> requestURI req</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  match p with</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;/&quot;</span> <span class="ot">-&gt;</span> </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>      set cors (okText (Nat.toText Store.get))</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;/increment&quot;</span> <span class="ot">-&gt;</span>                     </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>      Store.modify (n <span class="ot">-&gt;</span> n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>      set cors (ok Bytes.empty)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;/decrement&quot;</span> <span class="ot">-&gt;</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>      Store.modify (n <span class="ot">-&gt;</span> n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>      set cors (ok Bytes.empty)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    _  <span class="ot">-&gt;</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>      <span class="co">--  Return a bad request</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SimpleHttpResponse</span> cors <span class="dt">BadRequest</span> (<span class="dt">RawResponseBody</span> Bytes.empty)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>cors <span class="op">:</span> [<span class="dt">Header</span>]</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>cors <span class="ot">=</span> [<span class="dt">Header</span> <span class="st">&quot;Access-Control-Allow-Origin&quot;</span> <span class="st">&quot;*&quot;</span>]</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>saveStore <span class="op">:</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span>{<span class="dt">IO</span>, <span class="dt">Exception</span>, <span class="dt">Store</span> a} ()</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>saveStore path <span class="ot">=</span> writeDurable path (Store.get)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>readDurable <span class="op">:</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span>{<span class="dt">IO</span>, <span class="dt">Exception</span>} a</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>readDurable path <span class="ot">=</span> </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  throwLoad a <span class="ot">=</span> Throw.toBug '(<span class="dt">Either</span><span class="op">.</span>toThrow (Value.load a))</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  throwDeserialize b <span class="ot">=</span> Throw.toBug '(<span class="dt">Either</span><span class="op">.</span>toThrow (Value.deserialize b))</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  throwLoad (throwDeserialize (file<span class="op">.</span>bytes<span class="op">.</span><span class="fu">readFile</span> path))</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>writeDurable <span class="op">:</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span>{<span class="dt">IO</span>, <span class="dt">Exception</span>} ()</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>writeDurable path v <span class="ot">=</span> </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  file<span class="op">.</span>bytes<span class="op">.</span><span class="fu">writeFile</span> path (Value.serialize (Value.value v))</span></code></pre></div>
<h1 id="full-elm-source-code">Full Elm Source Code</h1>
<div class="sourceCode" id="cb8"><pre class="sourceCode elm"><code class="sourceCode elm"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">module</span> <span class="dt">Main</span> <span class="kw">exposing</span> (<span class="op">..</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Browser</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Html</span> <span class="kw">exposing</span> (<span class="dt">Html</span><span class="op">,</span> <span class="fu">button</span><span class="op">,</span> <span class="fu">div</span><span class="op">,</span> <span class="fu">text</span><span class="op">,</span> <span class="fu">pre</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Http</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Html</span><span class="op">.</span><span class="dt">Events</span> <span class="kw">exposing</span> (<span class="fu">onClick</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">-- MAIN</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">main</span> <span class="op">=</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Browser</span><span class="op">.</span><span class="fu">element</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    { <span class="fu">init</span> <span class="op">=</span> <span class="fu">init</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="fu">update</span> <span class="op">=</span> <span class="fu">update</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="fu">subscriptions</span> <span class="op">=</span> \<span class="fu">_</span> <span class="op">-&gt;</span> <span class="dt">Sub</span><span class="op">.</span><span class="fu">none</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="fu">view</span> <span class="op">=</span> <span class="fu">view</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">-- MODEL</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> <span class="dt">Model</span> </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">=</span> <span class="dt">Failure</span> <span class="dt">String</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">|</span> <span class="dt">Loading</span> </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">|</span> <span class="dt">Success</span> <span class="dt">String</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="fu">init</span> : () <span class="op">-&gt;</span> (<span class="dt">Model</span><span class="op">,</span> <span class="dt">Cmd</span> <span class="dt">Msg</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="fu">init</span> <span class="fu">_</span> <span class="op">=</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  ( <span class="dt">Loading</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="op">,</span> <span class="fu">getNumber</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co">-- UPDATE</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> <span class="dt">Msg</span> </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="op">=</span> <span class="dt">GotString</span> (<span class="dt">Result</span> <span class="dt">Http</span><span class="op">.</span><span class="dt">Error</span> <span class="dt">String</span>) </span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">Change</span> (<span class="dt">Result</span> <span class="dt">Http</span><span class="op">.</span><span class="dt">Error</span> ()) </span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">Increment</span> </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">Decrement</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span> : <span class="dt">Msg</span> <span class="op">-&gt;</span> <span class="dt">Model</span> <span class="op">-&gt;</span> (<span class="dt">Model</span><span class="op">,</span> <span class="dt">Cmd</span> <span class="dt">Msg</span>)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span> <span class="fu">msg</span> <span class="fu">model</span> <span class="op">=</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">case</span> <span class="fu">msg</span> <span class="cf">of</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">GotString</span> (<span class="dt">Ok</span> <span class="fu">n</span>) <span class="op">-&gt;</span> </span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>      (<span class="dt">Success</span> <span class="fu">n</span><span class="op">,</span> <span class="dt">Cmd</span><span class="op">.</span><span class="fu">none</span>)</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="dt">GotString</span> (<span class="dt">Err</span> <span class="fu">e</span>) <span class="op">-&gt;</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>      (<span class="dt">Failure</span> (<span class="fu">errorToString</span> <span class="fu">e</span>)<span class="op">,</span> <span class="dt">Cmd</span><span class="op">.</span><span class="fu">none</span>)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Change</span> (<span class="dt">Ok</span> ()) <span class="op">-&gt;</span> </span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>      (<span class="dt">Loading</span><span class="op">,</span> <span class="fu">getNumber</span>)</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Change</span> (<span class="dt">Err</span> <span class="fu">e</span>) <span class="op">-&gt;</span> </span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>      (<span class="dt">Failure</span> (<span class="fu">errorToString</span> <span class="fu">e</span>)<span class="op">,</span> <span class="dt">Cmd</span><span class="op">.</span><span class="fu">none</span>)</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Increment</span> <span class="op">-&gt;</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>      (<span class="dt">Loading</span><span class="op">,</span> <span class="fu">incNumber</span>)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Decrement</span> <span class="op">-&gt;</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>      (<span class="dt">Loading</span><span class="op">,</span> <span class="fu">decNumber</span>)</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="co">-- VIEW</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span> : <span class="dt">Model</span> <span class="op">-&gt;</span> <span class="dt">Html</span> <span class="dt">Msg</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span> <span class="fu">model</span> <span class="op">=</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">number</span> <span class="op">=</span> </span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>      <span class="cf">case</span> <span class="fu">model</span> <span class="cf">of</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Failure</span> <span class="fu">e</span> <span class="op">-&gt;</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>          <span class="fu">e</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Loading</span> <span class="op">-&gt;</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;Loading...&quot;</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Success</span> <span class="fu">n</span> <span class="op">-&gt;</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>          <span class="fu">n</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>  <span class="kw">in</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">div</span> []</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>      [ <span class="fu">button</span> [ <span class="fu">onClick</span> <span class="dt">Decrement</span> ] [ <span class="fu">text</span> <span class="st">&quot;-&quot;</span> ]</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>      <span class="op">,</span> <span class="fu">div</span> [] [ <span class="fu">text</span> <span class="fu">number</span> ]</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>      <span class="op">,</span> <span class="fu">button</span> [ <span class="fu">onClick</span> <span class="dt">Increment</span> ] [ <span class="fu">text</span> <span class="st">&quot;+&quot;</span> ]</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>      ]</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a><span class="co">-- HELPERS</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a><span class="fu">localhost</span> : <span class="dt">String</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a><span class="fu">localhost</span> <span class="op">=</span> <span class="st">&quot;http://localhost:5556&quot;</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a><span class="fu">getNumber</span> : <span class="dt">Cmd</span> <span class="dt">Msg</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a><span class="fu">getNumber</span> <span class="op">=</span></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Http</span><span class="op">.</span><span class="fu">get</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>    { <span class="fu">url</span> <span class="op">=</span> <span class="fu">localhost</span> <span class="op">++</span> <span class="st">&quot;/&quot;</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="fu">expect</span> <span class="op">=</span> <span class="dt">Http</span><span class="op">.</span><span class="fu">expectString</span> <span class="dt">GotString</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a><span class="fu">incNumber</span> : <span class="dt">Cmd</span> <span class="dt">Msg</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a><span class="fu">incNumber</span> <span class="op">=</span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Http</span><span class="op">.</span><span class="fu">post</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>    { <span class="fu">url</span> <span class="op">=</span> <span class="fu">localhost</span> <span class="op">++</span> <span class="st">&quot;/increment&quot;</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="fu">body</span> <span class="op">=</span> <span class="dt">Http</span><span class="op">.</span><span class="fu">emptyBody</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="fu">expect</span> <span class="op">=</span> <span class="dt">Http</span><span class="op">.</span><span class="fu">expectWhatever</span> <span class="dt">Change</span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a><span class="fu">decNumber</span> : <span class="dt">Cmd</span> <span class="dt">Msg</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a><span class="fu">decNumber</span> <span class="op">=</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Http</span><span class="op">.</span><span class="fu">post</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>    { <span class="fu">url</span> <span class="op">=</span> <span class="fu">localhost</span> <span class="op">++</span> <span class="st">&quot;/decrement&quot;</span></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="fu">body</span> <span class="op">=</span> <span class="dt">Http</span><span class="op">.</span><span class="fu">emptyBody</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="fu">expect</span> <span class="op">=</span> <span class="dt">Http</span><span class="op">.</span><span class="fu">expectWhatever</span> <span class="dt">Change</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a><span class="fu">errorToString</span> : <span class="dt">Http</span><span class="op">.</span><span class="dt">Error</span> <span class="op">-&gt;</span> <span class="dt">String</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a><span class="fu">errorToString</span> <span class="fu">e</span> <span class="op">=</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>  <span class="cf">case</span> <span class="fu">e</span> <span class="cf">of</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Http</span><span class="op">.</span><span class="dt">BadUrl</span> <span class="fu">s</span>     <span class="op">-&gt;</span> <span class="st">&quot;BadUrl &quot;</span> <span class="op">++</span> <span class="fu">s</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Http</span><span class="op">.</span><span class="dt">Timeout</span>      <span class="op">-&gt;</span> <span class="st">&quot;Timeout&quot;</span></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Http</span><span class="op">.</span><span class="dt">NetworkError</span> <span class="op">-&gt;</span> <span class="st">&quot;NetworkError&quot;</span></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Http</span><span class="op">.</span><span class="dt">BadStatus</span> <span class="fu">i</span>  <span class="op">-&gt;</span> <span class="st">&quot;BadStatus &quot;</span> <span class="op">++</span> <span class="dt">String</span><span class="op">.</span><span class="fu">fromInt</span> <span class="fu">i</span></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Http</span><span class="op">.</span><span class="dt">BadBody</span> <span class="fu">s</span>    <span class="op">-&gt;</span> <span class="st">&quot;BadBody &quot;</span> <span class="op">++</span> <span class="fu">s</span></span></code></pre></div>
    </section>
</article>

        </main>

        <footer>
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
